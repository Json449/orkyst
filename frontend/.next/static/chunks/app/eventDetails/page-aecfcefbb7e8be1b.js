(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[357],{47430:(e,t,r)=>{Promise.resolve().then(r.bind(r,30441))},16413:(e,t,r)=>{"use strict";r.d(t,{A:()=>m});var s=r(95155),a=r(12115),l=r(74676),n=r(63219),o=r(35906),i=r(25848);let d=()=>{let e=(0,o.jE)();return(0,i.n)({mutationFn:async()=>{let e=await fetch("/api/logout",{method:"GET"});if(!e.ok)throw Error("Logout failed");return e.json()},onSuccess:()=>{e.removeQueries(),e.clear(),localStorage.removeItem("APP_QUERY_CACHE"),sessionStorage.clear()},onError:e=>{console.error("Logout error:",e)}})};var c=r(76046),u=r(5565);let m=e=>{let{profile:t,editor:r,handleApproveChanges:o}=e,[i,m]=(0,a.useState)(!1),x=(0,a.useRef)(null),h=(0,c.useRouter)(),{mutate:g,isPending:p}=d();return(0,a.useEffect)(()=>{let e=e=>{x.current&&!x.current.contains(e.target)&&m(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,s.jsx)("header",{className:"sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-gray-100 shadow-sm",children:(0,s.jsxs)("div",{className:"mx-auto px-6 py-3 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Orkyst"}),r&&(0,s.jsx)("span",{className:"hidden md:inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"Artwork Editor"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[r&&o&&(0,s.jsx)("button",{onClick:o,className:"px-5 py-2 rounded-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-medium shadow-md hover:shadow-lg transition-all duration-200 hover:opacity-90 active:scale-95",children:"Save Changes"}),(0,s.jsxs)("div",{className:"relative",ref:x,children:[(0,s.jsxs)("button",{onClick:()=>m(e=>!e),className:"flex items-center space-x-2 focus:outline-none group",children:[(0,s.jsx)("div",{className:"relative",children:(null==t?void 0:t.avatar)?(0,s.jsx)(u.default,{src:t.avatar,alt:t.fullname||"User avatar",width:36,height:36,className:"w-9 h-9 rounded-full object-cover"}):(0,s.jsx)(l.A,{sx:{fontSize:36,color:"action.active",backgroundColor:"#f3f4f6",borderRadius:"50%"}})}),(0,s.jsxs)("div",{className:"hidden md:flex flex-col items-start",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:null==t?void 0:t.fullname}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Admin"})]}),(0,s.jsx)(n.A,{sx:{fontSize:20,color:"action.active",transform:i?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"}})]}),i&&(0,s.jsx)("div",{className:"absolute right-0 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-50 animate-fade-in",children:(0,s.jsxs)("div",{className:"py-1",children:[(0,s.jsxs)("div",{className:"px-4 py-2 border-b border-gray-100",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:null==t?void 0:t.fullname}),(0,s.jsx)("p",{className:"text-xs text-gray-500 truncate",children:null==t?void 0:t.email})]}),(0,s.jsx)("a",{href:"#",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:"Your Profile"}),(0,s.jsx)("a",{href:"#",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:"Settings"}),(0,s.jsx)("button",{onClick:()=>{g(void 0,{onSuccess:()=>h.push("/")})},disabled:p,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center",children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logging out..."]}):"Logout"})]})})]})]})]})})}},30441:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>z});var s=r(95155),a=r(12115),l=r(76046),n=r(65654),o=r(13876),i=r(82665),d=r(31924),c=r(9120),u=r(71119),m=r(7882),x=r(5565);let h=e=>{let{setImageUrl:t,generateImageLoading:r,imageUrl:l,onGenerateAI:n,onCloudinaryUpload:h}=e,[g,p]=(0,a.useState)("upload");console.log("sss",l);let[v,f]=(0,a.useState)(""),[b,j]=(0,a.useState)(!1),y=(0,a.useRef)(null),w=(0,a.useRef)(null),N=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?j(!0):"dragleave"===e.type&&j(!1)},k=async e=>{var r;let s=null===(r=e.target.files)||void 0===r?void 0:r[0];if(s)try{let e=URL.createObjectURL(s);t(e)}catch(e){console.error("Error uploading image:",e)}},C=async()=>{n&&v.trim()&&n(v)};return(0,a.useEffect)(()=>{"generate"===g&&w.current&&w.current.focus()},[g]),(0,s.jsxs)("div",{className:"mx-auto bg-white rounded-xl shadow-2xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100",children:[(0,s.jsxs)("button",{className:"flex-1 py-2 px-4 font-semibold text-lg transition-all duration-300 flex items-center justify-center gap-2 ".concat("upload"===g?"text-blue-600 border-b-2 border-blue-600 bg-white shadow-sm":"text-gray-500 hover:text-gray-700"),onClick:()=>p("upload"),children:[(0,s.jsx)(o.A,{fontSize:"medium"}),"Upload Image"]}),(0,s.jsxs)("button",{className:"flex-1 py-2 px-4 font-semibold text-lg transition-all duration-300 flex items-center justify-center gap-2 ".concat("generate"===g?"text-purple-600 border-b-2 border-purple-600 bg-white shadow-sm":"text-gray-500 hover:text-gray-700"),onClick:()=>p("generate"),children:[(0,s.jsx)(i.A,{fontSize:"medium"}),"AI Generate"]})]}),(0,s.jsx)("div",{className:"bg-gradient-to-br from-gray-50 to-white",children:"upload"===g?(0,s.jsx)(s.Fragment,{children:l?(0,s.jsxs)("div",{className:"relative group rounded-xl overflow-hidden shadow-lg",children:[(0,s.jsx)(x.default,{src:l,alt:"Uploaded",width:800,height:500,className:"w-full h-[44vh] object-cover transition-transform duration-500 group-hover:scale-105"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6",children:(0,s.jsxs)("button",{onClick:h,className:"bg-white/90 text-gray-800 px-6 py-3 rounded-full font-medium hover:bg-white transition-all transform translate-y-4 group-hover:translate-y-0 shadow-lg flex items-center gap-2",children:[(0,s.jsx)(d.A,{fontSize:"small"}),"Change Image"]})})]}):(0,s.jsxs)("div",{className:"h-[44vh] rounded-xl border-2 ".concat(b?"border-blue-400 bg-blue-50":"border-dashed border-gray-300"," flex justify-center items-center flex-col cursor-pointer transition-all duration-300 relative overflow-hidden"),onClick:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.click()},onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:e=>{e.preventDefault(),e.stopPropagation(),j(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&k({target:{files:e.dataTransfer.files}})},children:[r?(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)(c.A,{className:"animate-spin text-blue-500",style:{fontSize:"4rem"}}),(0,s.jsx)("p",{className:"text-gray-600 font-medium mt-4",children:"Processing your image..."}),(0,s.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"This won't take long"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsx)("div",{className:"w-24 h-24 bg-blue-100 rounded-2xl flex items-center justify-center",children:(0,s.jsx)(u.A,{className:"text-3xl text-blue-500"})}),(0,s.jsx)("div",{className:"absolute -right-2 -top-2 bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center shadow-md",children:(0,s.jsx)(m.A,{className:"text-sm"})})]}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:b?"Drop your image here":"Drag & drop your image"}),(0,s.jsx)("p",{className:"text-gray-500 mb-6",children:"or click to browse files"}),(0,s.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-full font-medium hover:shadow-lg transition-all flex items-center gap-2",children:[(0,s.jsx)(o.A,{fontSize:"small"}),"Select File"]}),(0,s.jsx)("div",{className:"absolute bottom-4 text-xs text-gray-400",children:"Supports JPG, PNG, WEBP (Max 10MB)"})]}),(0,s.jsx)("input",{ref:y,type:"file",onChange:k,className:"hidden",accept:"image/*"})]})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex gap-3",children:(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)("input",{ref:w,type:"text",value:v,onChange:e=>f(e.target.value),placeholder:"Describe the image you want to create...",className:"w-full px-6 py-4 border-0 rounded-xl bg-gray-100 focus:ring-2 focus:ring-purple-500 focus:bg-white text-gray-700 placeholder-gray-400 pr-24 shadow-inner transition-all duration-300",onKeyDown:e=>"Enter"===e.key&&C()}),(0,s.jsx)("button",{onClick:C,disabled:r||!v.trim(),className:"absolute right-2 top-2 px-5 py-2 rounded-lg font-medium text-white flex items-center gap-2 transition-all ".concat(r||!v.trim()?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-purple-500 to-pink-500 hover:shadow-lg"),children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.A,{className:"animate-spin",fontSize:"small"}),"Creating..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{fontSize:"small"}),"Generate"]})})]})}),(0,s.jsx)("div",{className:"relative group rounded-xl overflow-hidden shadow-lg bg-gradient-to-br from-gray-100 to-gray-50 h-[29vh] flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center p-8",children:[(0,s.jsx)("div",{className:"mx-auto w-28 h-28 bg-gradient-to-r from-purple-100 to-pink-100 rounded-full flex items-center justify-center mb-6",children:(0,s.jsx)(i.A,{className:"text-4xl text-purple-500"})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-gray-700 mb-3",children:"Unleash Your Creativity"}),(0,s.jsx)("p",{className:"text-gray-500 max-w-md mx-auto mb-6",children:r?"Our AI is crafting your masterpiece...":"Describe what you envision and we&apos;ll generate it for you"}),r&&(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)(c.A,{className:"animate-spin text-purple-500",style:{fontSize:"3rem"}}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mt-3",children:"This usually takes 10-30 seconds"})]})]})}),!r&&!l&&(0,s.jsx)("div",{className:"grid grid-cols-3 gap-3 mt-4",children:["Cyberpunk cityscape","Surreal forest landscape","Portrait of a futuristic samurai"].map(e=>(0,s.jsxs)("button",{onClick:()=>{f(e),setTimeout(()=>{var e;return null===(e=w.current)||void 0===e?void 0:e.focus()},0)},className:"text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-lg transition-colors truncate",children:['"',e,'"']},e))})]})})]})};var g=r(16413),p=r(12507);let v=e=>{let{children:t}=e;return(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-white border-t-transparent"}),t&&(0,s.jsx)("p",{className:"mt-4 text-white text-lg font-medium",children:t})]})})},f=e=>{let{isOpen:t,currentVersion:r,onSave:l,onCancel:n}=e,[o,i]=(0,a.useState)(""),[d,c]=(0,a.useState)("current");return t?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg w-96",children:[(0,s.jsx)("h3",{className:"text-black text-xl font-bold mb-4",children:"Save Changes"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("p",{className:"mb-2 text-black",children:["Current Version: v",r]}),(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("input",{type:"radio",id:"currentVersion",checked:"current"===d,onChange:()=>c("current"),className:"mr-2"}),(0,s.jsx)("label",{htmlFor:"currentVersion",className:"text-gray-600",children:"Update current version"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",id:"newVersion",checked:"new"===d,onChange:()=>c("new"),className:"mr-2"}),(0,s.jsx)("label",{htmlFor:"newVersion",className:"text-gray-600",children:"Create new version"})]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"comment",className:"text-gray-600 block mb-2",children:"Version Comment (Optional):"}),(0,s.jsx)("textarea",{id:"comment",value:o,onChange:e=>i(e.target.value),className:"w-full p-2 border rounded text-gray-600",rows:3})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)("button",{onClick:n,className:"px-4 py-2 bg-gray-400 rounded",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>l(d,o),className:"px-4 py-2 bg-blue-500 text-white rounded",children:"Save"})]})]})}):null};var b=r(35906),j=r(25848);let y=()=>{let e=(0,b.jE)();return(0,j.n)({mutationFn:async e=>{let t=await fetch("/api/events/details?id=".concat(e),{method:"GET"}),r=await t.json();if(!t.ok)throw Error(r.message||"Failed to fetch AI tips");return r},onSuccess:t=>{console.log("dataassss",t),e.setQueryData(["events",t],t)},onError:e=>{console.log("Error fetching AI tips:",null==e?void 0:e.message)}})};var w=r(61116);r(36439);let N=e=>{let{value:t="<div></div>",loading:r,onChangeContent:l,handleFeedbackSubmit:n,eventType:o,highlightContent:i}=e,d=(0,a.useRef)(null),c=(0,a.useRef)(null),[u,m]=(0,a.useState)(""),[x,h]=(0,a.useState)(!1),[g,p]=(0,a.useState)(""),[v,f]=(0,a.useState)({top:0,left:0}),b=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(d.current&&i){let e=d.current;e.dom.removeClass(e.dom.select("span.highlighted-content"),"highlighted-content"),i.trim()&&e.execCommand("SearchReplace",!1,{find:i,replace:'<span class="highlighted-content">'.concat(i,"</span>"),all:!0,case_sensitive:!1,whole_words:!1})}},[i]),(0,a.useEffect)(()=>{let e=e=>{b.current&&!b.current.contains(e.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,s.jsx)("div",{className:"relative",children:r?(0,s.jsx)("p",{className:"mt-5 text-md text-black",children:"Content Loading..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.K,{apiKey:"dungff8svz2oxszu46ko0tng5ic4pu5fap9ggle4pxfnag2r",value:t,onInit:(e,t)=>{d.current=t,i&&t.on("init",()=>{t.execCommand("SearchReplace",!1,{find:i,replace:'<span class="highlighted-content">'.concat(i,"</span>"),all:!0})}),t.on("selectionchange",()=>{c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{let e=t.selection,r=e.getContent();if(r&&r.trim().length>0){let t=e.getRng().getBoundingClientRect();m(r),f({top:t.bottom+window.scrollY,left:t.left+window.scrollX}),h(!0)}else h(!1)},300)})},init:{height:"Blog Post"!=o?"86vh":"37vh",menubar:!0,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount","fontselect fontsizeselect"],toolbar:"".concat("Blog Post"!=o&&"image"," | formatselect | fontselect fontsizeselect | bold italic backcolor | \n                  alignleft aligncenter alignright alignjustify | \n                  bullist numlist outdent indent | undo redo | removeformat | help"),content_style:'\n                body {\n                  font-family: Arial, sans-serif;\n                  font-size: 16px;\n                  line-height: 1.6;\n                  color: #333;\n                }\n                .highlighted-comment {\n                  background-color: #fff9c4;\n                  position: relative;\n                }\n                .highlighted-comment::after {\n                  content: "\uD83D\uDCAC";\n                  font-size: 12px;\n                  position: absolute;\n                  right: -15px;\n                  top: -8px;\n                }\n                .highlighted-content {\n                  background-color: #d4edff;\n                  padding: 0 2px;\n                  border-radius: 3px;\n                  box-shadow: 0 0 0 1px #b8daff;\n                  animation: pulse 2s infinite;\n                }\n                @keyframes pulse {\n                  0% { background-color: #d4edff; }\n                  50% { background-color: #b8daff; }\n                  100% { background-color: #d4edff; }\n                }\n              ',setup:e=>{e.on("init",()=>{i&&e.execCommand("SearchReplace",!1,{find:i,replace:'<span class="highlighted-content">'.concat(i,"</span>"),all:!0})})}},onEditorChange:e=>{null==l||l(e)}}),x&&(0,s.jsxs)("div",{ref:b,className:"absolute z-50 bg-white p-4 rounded shadow-lg border border-gray-300",style:{top:"".concat(v.top,"px"),left:"".concat(v.left,"px")},children:[(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)("p",{className:"text-sm text-gray-600",children:u})}),(0,s.jsx)("textarea",{className:"w-full p-2 border rounded mb-2 text-gray-600",placeholder:"Add your comment...",rows:3,onChange:e=>p(e.target.value)}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)("button",{onClick:()=>h(!1),className:"text-black px-3 py-1 text-sm bg-gray-200 rounded",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>{d.current&&u&&d.current.execCommand("mceInsertContent",!1,'<span class="highlighted-comment" data-comment="'.concat(g,'">').concat(u,"</span>")),h(!1),n(u,g)},className:"px-3 py-1 text-sm bg-blue-500 text-white rounded",children:"Add Comment"})]})]})]})})},k=async(e,t)=>{let r=await fetch(e,t);if(!r.ok)throw Error("Failed to fetch: ".concat(r.statusText));return r.json()},C=e=>{let{versionHistory:t}=e;return(0,s.jsx)("div",{className:"overflow-y-auto h-full scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:t.length>0?(0,s.jsx)("div",{className:"space-y-3 pr-2",children:t.map((e,t)=>{var r,a,l,o,i,d,c,u;return(0,s.jsxs)("div",{className:"relative group flex items-start gap-3 p-3 bg-white rounded-xl border border-gray-100 hover:border-purple-200 transition-all shadow-xs hover:shadow-sm",children:[(0,s.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-50 to-purple-100 flex items-center justify-center border border-purple-100",children:(0,s.jsx)("span",{className:"text-purple-600 font-medium text-lg",children:(null==e?void 0:null===(l=e.updatedBy)||void 0===l?void 0:null===(a=l.fullname)||void 0===a?void 0:null===(r=a[0])||void 0===r?void 0:r.toUpperCase())||"U"})}),(0,s.jsxs)("div",{className:"absolute -bottom-1 -right-1 bg-gradient-to-r from-purple-600 to-purple-500 text-white text-[0.65rem] font-bold rounded-full w-5 h-5 flex items-center justify-center shadow-xs",children:["v",e.version]})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0 space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-baseline justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-gray-900 truncate",children:(null==e?void 0:null===(o=e.updatedBy)||void 0===o?void 0:o.fullname)||"Unknown User"}),0===t&&(0,s.jsx)("span",{className:"text-[0.65rem] px-1.5 py-0.5 rounded-full bg-green-100 text-green-800",children:"Current"})]}),(0,s.jsx)("span",{className:"text-xs text-gray-400 ml-2 whitespace-nowrap",children:(0,n.f)(e.createdAt)})]}),(null==e?void 0:null===(i=e.changes)||void 0===i?void 0:i.comment)&&(0,s.jsx)("p",{className:"mt-0.5 text-sm text-gray-600 group-hover:text-gray-800 line-clamp-2",children:null==e?void 0:null===(d=e.changes)||void 0===d?void 0:d.comment}),(0,s.jsxs)("div",{className:"mt-1.5 flex flex-wrap gap-1",children:[(null===(c=e.changes)||void 0===c?void 0:c.description)&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-[0.65rem] font-medium bg-blue-50 text-blue-700 border border-blue-100",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mr-1 h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Content"]}),(null===(u=e.changes)||void 0===u?void 0:u.artwork)&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-[0.65rem] font-medium bg-green-50 text-green-700 border border-green-100",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mr-1 h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Artwork"]})]})]}),(0,s.jsx)("button",{className:"absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity text-gray-300 hover:text-purple-500",onClick:()=>console.log("View version",e.version),title:"View this version",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]},t)})}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[(0,s.jsxs)("div",{className:"relative w-16 h-16 mb-4",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-purple-50 rounded-full blur-sm"}),(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"relative z-10 h-16 w-16 text-purple-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})]}),(0,s.jsx)("h4",{className:"text-lg font-medium text-gray-500",children:"No versions yet"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-400 max-w-xs",children:"Your first edit will create version 1 automatically"})]})})},S=e=>{let{feedback:t,loading:r}=e;return(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Feedback & Revisions"}),(0,s.jsx)("button",{className:"p-2 rounded-full bg-blue-50 text-blue-600 hover:bg-blue-100 transition",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:r?(0,s.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,t)=>(0,s.jsxs)("div",{className:"animate-pulse",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,s.jsx)("div",{className:"h-3 bg-gray-100 rounded w-1/2 mb-3"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-5/6 mt-1"})]},t))}):t.length>0?t.map(e=>{var t;return(0,s.jsx)("div",{className:"p-3 rounded-lg hover:bg-gray-50 transition cursor-pointer border border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-medium",children:e.userId.fullname.charAt(0)})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-gray-800 truncate",children:e.userId.fullname}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:(0,n.f)(e.createdAt)})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1 whitespace-pre-line",children:e.comment}),(null==e?void 0:null===(t=e.attachments)||void 0===t?void 0:t.length)>0&&(0,s.jsx)("div",{className:"mt-2 flex gap-2",children:e.attachments.map((e,t)=>(0,s.jsx)("div",{className:"p-1 border rounded text-xs text-gray-500 hover:bg-gray-50",children:e.name},t))}),(0,s.jsxs)("div",{className:"mt-2 flex gap-2 text-xs",children:[(0,s.jsx)("button",{className:"text-blue-500 hover:text-blue-700",children:"Reply"}),(0,s.jsx)("button",{className:"text-gray-500 hover:text-gray-700",children:"Resolve"})]})]})]})},e._id)}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),(0,s.jsx)("h4",{className:"mt-2 text-sm font-medium text-gray-700",children:"No feedback yet"}),(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Be the first to share your thoughts"}),(0,s.jsx)("button",{className:"mt-4 px-4 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 transition",children:"Add Feedback"})]})}),(0,s.jsx)("div",{className:"p-4 border-t border-gray-100",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"text",placeholder:"Add your feedback...",className:"w-full p-3 pr-12 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"}),(0,s.jsx)("button",{className:"absolute right-3 top-3 text-blue-500 hover:text-blue-700",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z",clipRule:"evenodd"})})})]})})]})};function I(){var e,t;let r=(0,l.useSearchParams)(),[n,o]=(0,a.useState)(""),[i,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!1),[m,x]=(0,a.useState)(""),[b,j]=(0,a.useState)(null),{data:w=[]}=(0,p.x)(),[I,z]=(0,a.useState)(!1),[A,L]=(0,a.useState)(),{mutate:E}=y(),R=r.get("eventId");(0,a.useEffect)(()=>{var e;x(null!==(e=null==b?void 0:b.description)&&void 0!==e?e:"")},[null==b?void 0:b.description]);let M=(0,a.useCallback)(async(e,t,r)=>{try{if(u(!0),!(null==e?void 0:e.artwork)||null!=t||null!=r){var s;let a="/api/events/generateImage?id=".concat(R),l={theme:null==e?void 0:e.theme,audience:null==e?void 0:e.audienceFocus,contentType:null==e?void 0:e.type,aiPrompt:t,cloudinaryUrl:r},n=await k(a,{method:"PUT",body:JSON.stringify(l)});console.log("asdsadsad",n),j(e=>{var t;return{...e,artwork:null==n?void 0:null===(t=n.data)||void 0===t?void 0:t.result}}),o(null==n?void 0:null===(s=n.data)||void 0===s?void 0:s.result)}}catch(e){console.error("Error fetching event details:",e)}finally{u(!1)}},[R,u,j,o]),B=(0,a.useCallback)(e=>{u(!0),E(e,{onSuccess:e=>{var t,r;u(!1),console.log("event details:",e),j(t=>{var r,s;return{...t,...null==e?void 0:e.data,artwork:(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.artwork)||(null==n?void 0:null===(s=n.data)||void 0===s?void 0:s.result)}}),o((null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.artwork)||(null==n?void 0:null===(r=n.data)||void 0===r?void 0:r.result)),M(null==e?void 0:e.data,null,null)},onError:e=>{u(!1),console.error("Failed:",e.message)}})},[E,u,j,o,M,null==n?void 0:null===(e=n.data)||void 0===e?void 0:e.result]);(0,a.useEffect)(()=>{R&&B(R)},[R,B]);let D=async(e,t)=>{if(!R||!A)return;let r={eventId:R,changes:{...A,comment:t||"No comment provided"},versionAction:e};try{d(!0),await k("/api/events/content",{method:"PUT",body:JSON.stringify(r)}),z(!1),B(R)}catch(e){console.error("Error saving changes:",e)}finally{d(!1)}},P=async()=>{L({description:m}),z(!0)},T=async(e,t)=>{if(R)try{d(!0),await k("/api/events/feedback",{method:"POST",body:JSON.stringify({eventId:R,comment:t,text:e})}),B(R)}catch(e){console.error("Error submitting feedback:",e)}finally{d(!1)}},F=async()=>{if(!n){console.error("No file selected");return}let e=await fetch(n),t=await e.blob(),r=new File([t],"uploaded-image",{type:t.type}),s=new FormData;s.append("file",r),u(!0);try{let e=await fetch("/api/cloudinary/upload",{method:"POST",body:s}),t=await e.json();if(t.success)return M(b,null,t.url),t.url;console.error(t.error)}catch(e){console.error("Error uploading image:",e)}finally{u(!1)}};return b?(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsxs)("div",{className:"bg-white w-full",children:[(0,s.jsx)(g.A,{handleApproveChanges:P,editor:!0,contentType:null==b?void 0:b.type,profile:w}),(0,s.jsx)(f,{isOpen:I,currentVersion:(null==b?void 0:b.version)||1,onSave:D,onCancel:()=>z(!1)}),i&&(0,s.jsx)(v,{}),(0,s.jsxs)("div",{className:"flex w-full bg-white",children:[(0,s.jsxs)("div",{className:"w-[22%] bg-white border-r border-gray-100 flex flex-col",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-b from-white to-gray-50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-purple-50 text-purple-600",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Version History"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Track all document changes"})]})]}),(0,s.jsxs)("div",{className:"mt-3 relative",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search versions...",className:"w-full pl-8 pr-3 py-1.5 text-sm border border-gray-200 rounded-lg focus:ring-1 focus:ring-purple-300 focus:border-purple-300"}),(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"absolute left-2.5 top-2 h-3.5 w-3.5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2IiBoZWlnaHQ9IjYiPgo8cmVjdCB3aWR0aD0iNiIgaGVpZ2h0PSI2IiBmaWxsPSIjZmZmIj48L3JlY3Q+CjxwYXRoIGQ9Ik0wIDBMNiA2IiBzdHJva2U9IiNlZGVkZWQiIHN0cm9rZS13aWR0aD0iMC41Ij48L3BhdGg+CjxwYXRoIGQ9Ik02IDBMMCA2IiBzdHJva2U9IiNlZGVkZWQiIHN0cm9rZS13aWR0aD0iMC41Ij48L3BhdGg+Cjwvc3ZnPg==')]",children:(0,s.jsx)(C,{versionHistory:(null==b?void 0:b.versionHistory)||[]})}),(0,s.jsx)("div",{className:"p-3 border-t border-gray-100 bg-white text-center",children:(0,s.jsx)("div",{className:"inline-flex items-center px-3 py-1 rounded-full bg-purple-50 border border-purple-100",children:(0,s.jsxs)("span",{className:"text-xs font-medium text-purple-700",children:["Current: v",(null==b?void 0:b.version)||1]})})})]}),(0,s.jsxs)("div",{className:"h-[86vh] flex-1 shadow-lg",children:[!i&&(null==b?void 0:b.type)!="Blog Post"&&(0,s.jsx)(h,{generateImageLoading:c,setImageUrl:o,imageUrl:n,onGenerateAI:e=>M(b,e,null),onCloudinaryUpload:F}),(0,s.jsx)(N,{loading:i,highlightContent:"In today's fast-paced digital landscape, small an",handleFeedbackSubmit:(e,t)=>T(e,t),onChangeContent:x,value:m,eventType:null!==(t=null==b?void 0:b.type)&&void 0!==t?t:""})]}),(0,s.jsx)("div",{className:"w-[24%] bg-white ml-3 rounded-xl overflow-hidden",children:(0,s.jsx)("div",{className:"h-[86vh] shadow-lg flex flex-col",children:(0,s.jsx)(S,{feedback:(null==b?void 0:b.feedback)||[],loading:i})})})]})]})}):(0,s.jsx)("div",{children:"Loading event details..."})}function z(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsx)(I,{})})}},12507:(e,t,r)=>{"use strict";r.d(t,{x:()=>a});var s=r(547);let a=()=>(0,s.I)({queryKey:["profile"],queryFn:async()=>{var e;let t=await fetch("/api/profile"),r=await t.json();return(null==r?void 0:null===(e=r.data)||void 0===e?void 0:e.result)||[]},staleTime:36e5})},65654:(e,t,r)=>{"use strict";function s(e){let t=new Date,r=new Date(e),s=Math.floor((t.getTime()-r.getTime())/1e3),a={year:31536e3,month:2592e3,day:86400,hour:3600,minute:60};if(s>=a.year){let e=Math.floor(s/a.year);return"".concat(e," year").concat(e>1?"s":""," ago")}if(s>=a.month){let e=Math.floor(s/a.month);return"".concat(e," month").concat(e>1?"s":""," ago")}if(s>=a.day){let e=Math.floor(s/a.day);return"".concat(e," day").concat(e>1?"s":""," ago")}if(s>=a.hour){let e=Math.floor(s/a.hour);return"".concat(e," hour").concat(e>1?"s":""," ago")}{if(!(s>=a.minute))return"Just now";let e=Math.floor(s/a.minute);return"".concat(e," minute").concat(e>1?"s":""," ago")}}r.d(t,{X:()=>a,f:()=>s});var a=function(e){return e.ADMIN="admin",e.EDITOR="editor",e.OWNER="owner",e}({})},36439:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[238,245,239,874,222,441,517,977],()=>t(47430)),_N_E=e.O()}]);